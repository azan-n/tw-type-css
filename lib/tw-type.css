:root {
  --tw-type-scale-ratio: 1.25;
  --tw-type-scale-base: 1rem;
}

/* TODO, use outside Tailwind?? */
@theme inline {
  --text-100: calc(var(--text-200) / var(--tw-type-scale-ratio));
  --text-100--line-height: var(--leading-160);
  --text-200: calc(var(--text-300) / var(--tw-type-scale-ratio));
  --text-200--line-height: var(--leading-150);
  --text-300: var(--tw-type-scale-base);
  --text-300--line-height: var(--leading-150);
  --text-400: calc(var(--text-300) * var(--tw-type-scale-ratio));
  --text-400--line-height: var(--leading-150);
  --text-500: calc(var(--text-400) * var(--tw-type-scale-ratio));
  --text-500--line-height: var(--leading-130);
  --text-600: calc(var(--text-500) * var(--tw-type-scale-ratio));
  --text-600--line-height: var(--leading-120);
  --text-700: calc(var(--text-600) * var(--tw-type-scale-ratio));
  --text-700--line-height: var(--leading-120);
  --text-800: calc(var(--text-700) * var(--tw-type-scale-ratio));
  --text-800--line-height: var(--leading-110);
  --text-900: calc(var(--text-800) * var(--tw-type-scale-ratio));
  --text-900--line-height: var(--leading-110);
  --text-1000: calc(var(--text-900) * var(--tw-type-scale-ratio));
  --text-1000--line-height: var(--leading-100);

  --leading-160: 1.6;
  --leading-150: 1.5;
  --leading-130: 1.3;
  --leading-120: 1.2;
  --leading-110: 1.1;
  --leading-100: 1;

  
  --tracking-003: 0.03em;
  --tracking-002: 0.02em;
  --tracking-001: 0.01em;
  --tracking-000: 0em;
  
  --font-weight-300: 300;
  --font-weight-400: 400;
  --font-weight-500: 500;
  --font-weight-700: 700;
}

/* TODO, using variables here (like with --tw-*) can allow customization for all prose blocks across the project. */
@utility display {
  font-size: var(--text-1000);
  line-height: var(--leading-100);
  letter-spacing: calc(-1 * var(--tracking-003));
  font-weight: var(--font-weight-300);
}

@utility heading-1 {
  --tw-type-heading-1-font-weight: var(--font-weight-300); 
  font-size: var(--text-800);
  line-height: var(--leading-110);
  letter-spacing: calc(-1 * var(--tracking-003));
  font-weight: var(--tw-type-heading-1-font-weight);
} 

@utility heading-2 {
  font-size: var(--text-700);
  line-height: var(--leading-110);
  letter-spacing: calc(-1 * var(--tracking-003));
  font-weight: var(--font-weight-500);
}

@utility heading-3 {
  font-size: var(--text-600);
  line-height: var(--leading-120);
  letter-spacing: calc(-1 * var(--tracking-002));
  font-weight: var(--font-weight-500);
}

@utility heading-4 {
  font-size: var(--text-500);
  line-height: var(--leading-120);
  letter-spacing: calc(-1 * var(--tracking-002));
  font-weight: var(--font-weight-700)
}

@utility heading-5 {
  font-size: var(--text-400);
  line-height: var(--leading-130);
  letter-spacing: calc(-1 * var(--tracking-001));
  font-weight: var(--font-weight-700);
}

@utility body-lg {
  font-size: var(--text-400);
  line-height: var(--leading-150);
  letter-spacing: var(--tracking-001);
  font-weight: var(--font-weight-400);
}

@utility body-base {
  font-size: var(--text-300);
  line-height: var(--leading-150);
  letter-spacing: var(--tracking-002);
  font-weight: var(--font-weight-400);
}

@utility body-sm {
  font-size: var(--text-200);
  line-height: var(--leading-160);
  letter-spacing: var(--tracking-003);
  font-weight: var(--font-weight-400);
}

/* TODO Color?? */
@utility tw-prose {
  @apply body-base;

  * + * {
    margin-block-start: var(--tw-prose-spacing, 1em);
  }

  h1 {
    @apply heading-1;
  }


  h2 {
    @apply heading-2;
  }


  h3 {
    @apply heading-3;
  }


  h4 {
    --tw-prose-spacing: --spacing(12);
    @apply heading-4;
  }

  h5 {
    --tw-prose-spacing: --spacing(12);
    @apply heading-5;
  }

  :is(h1, h2, h3) {
    --tw-prose-spacing: --spacing(16);
  }

  :is(h1, h2, h3) + * {
    --tw-prose-spacing: --spacing(6);
  }

  p {
    --tw-prose-spacing: --spacing(6);
  }

  ul,
  ol, 
  dl {
    --tw-prose-spacing: --spacing(4);
    display: flex;
    flex-direction: column;
    gap: --spacing(2);
    padding: 0;
    margin-inline-start: --spacing(6);
    line-height: var(--leading-150);
  }


  ul {
    list-style-type: disc;
  }

  ol {
    list-style-type: decimal;
  }

  li {
    --tw-prose-spacing: 0;
  }

  strong {
    font-weight: var(--font-weight-700);
  }

  em {
    font-variation-settings: 'ital' 10;
    font-synthesis: none;
  }

  a {
    text-decoration: underline;
    text-underline-position: under;
    position: relative;
  }

  code {
    font-family: var(--font-mono);
    white-space: break-spaces;
    padding: --spacing(1) --spacing(2);
  }

  pre {
    padding: --spacing(4);
  }

  pre code {
    padding: 0;
  }

  img {
    /* --tw-prose-spacing: ???; */
    display: block;
    max-width: 100%;
    height: auto;
    margin-left: auto;
    margin-right: auto;
    /* Might end up in a figure or  */
    margin-block-end: var(--tw-prose-spacing);
  }

  blockquote {
    /* --tw-prose-spacing: ???; */
    @apply text-300;
    font-weight: var(--font-weight-700);
    padding-block-end: --spacing(8);
    padding-top: --spacing(2);
    padding-bottom: --spacing(2);
  }

  blockquote p::before {
    content: open-quote;
  }

  blockquote p::after {
    content: close-quote;
  }


  figure figcaption {
    --tw-prose-spacing: --spacing(6);
    @apply text-200;
    font-family: var(--brand-fontStack-monospace);
    color: var(--brand-color-text-muted);
  }

  figcaption {
    @apply text-200;
    font-weight: var(--font-weight-100);
  }

  hr {
    --tw-prose-spacing: --spacing(16);
    margin-block-start: var(--tw-prose-spacing);
    margin-block-end: var(--tw-prose-spacing);
  }

  video,
  iframe[src*='youtube.com'],
  iframe[src*='youtu.be'],
  iframe[src*='youtube-nocookie.com'] {
    /* TODO --tw-prose-spacing: ??? */
    display: block;
    height: auto;
    margin-left: auto;
    margin-right: auto;
    margin-block-end: var(--tw-prose-spacing);
  }

  video {
    max-width: 100%;
  }

  iframe[src*='youtube.com'],
  iframe[src*='youtu.be'],
  iframe[src*='youtube-nocookie.com'] {
    width: 100%;
    aspect-ratio: 16 / 9;
  }

  table {
    --tw-prose-spacing: --spacing(8);
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    @apply text-200;
  }

  table caption {
    text-align: left;
    padding-block-end: --spacing(6);
    font-weight: var(--font-weight-normal);
  }

  table th,
  table td {
    padding-block: --spacing(4);
    padding-inline: --spacing(3);
    text-align: left;
    vertical-align: top;
    @apply border-b;
  }

  table th:first-child,
  table td:first-child,
  table th:last-child,
  table td:last-child {
    padding-inline: 0;
  }

  table th {
    @apply text-200;
    line-height: var(--leading-160);
    font-weight: var(--font-weight-normal);
  }

  /* TODO is using border-b here okay?? */
  table thead th {
    @apply border-b;
  }

  table tbody tr:last-child td {
    border-bottom: none;
  }


  td > ul:first-child,
  td > ol:first-child {
    margin-block-start: 0;
  }

  dt {
    font-weight: var(--font-weight-bold);
  }

  dd {
    --tw-prose-spacing: 0;
  }

}